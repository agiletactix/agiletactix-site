---
import LandingLayout from '../layouts/LandingLayout.astro';
import ParticleNetwork from '../components/ParticleNetwork.astro';

const pageTitle = 'Free Agile AI Prompt Playbook';
const pageDescription = 'Get 5 copy-paste AI prompts that make you sound technical in sprint planning, refinement, and retrospectives—even if you\'ve never touched ChatGPT before.';
---

<LandingLayout title={pageTitle} description={pageDescription}>
  <!-- Hero Section with Particle Network Background (matches homepage) -->
  <section class="relative bg-black overflow-hidden min-h-[600px] lg:min-h-[700px] flex items-center">
    <!-- Particle Animation Background -->
    <ParticleNetwork />

    <!-- Content -->
    <div class="relative z-10 pt-24 pb-16 lg:py-24 mx-auto px-6 sm:px-8 lg:px-16 xl:px-24 max-w-[1600px] w-full">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-center">

        <!-- Left Column - Text Content -->
        <div class="max-w-2xl animate-fade-in">
          <!-- Main Headline (matches homepage h1 styling) -->
          <h1 class="text-4xl sm:text-5xl lg:text-6xl xl:text-7xl font-extrabold tracking-tight mb-8 animate-slide-up" style="animation-delay: 0.1s; letter-spacing: -0.03em;">
            <span class="text-white">How I Got Rehired in </span>
            <span class="text-primary-400">2 Weeks</span>
            <span class="text-white"> After Being Laid Off With Thousands of Other Scrum Masters</span>
          </h1>

          <!-- Subheadline (matches homepage) -->
          <p class="text-lg sm:text-xl text-gray-300 mb-6 max-w-2xl leading-relaxed font-medium animate-slide-up" style="animation-delay: 0.2s;">
            When companies started cutting "ceremony-only" agile roles in January 2023, I learned how to think and speak like a builder — not just a facilitator.
          </p>

          <!-- Value proposition -->
          <p class="text-lg text-gray-300 mb-8 animate-slide-up" style="animation-delay: 0.25s;">
            This <span class="text-primary-400 font-semibold">free playbook</span> is your first step to proving technical value.
          </p>

          <!-- CTA Button (matches homepage btn-primary) -->
          <div class="animate-slide-up" style="animation-delay: 0.3s;">
            <button
              type="button"
              data-modal-trigger="playbook"
              class="btn-primary text-lg px-10 py-4"
            >
              <span class="relative z-10">Get the Free Playbook</span>
            </button>
          </div>
        </div>

        <!-- Right Column - YouTube Video -->
        <div class="animate-fade-in lg:animate-slide-left" style="animation-delay: 0.3s;">
          <div class="aspect-video rounded-2xl overflow-hidden shadow-2xl bg-white/5 backdrop-blur-sm border border-primary-600/20">
            <iframe
              width="100%"
              height="100%"
              src="https://www.youtube.com/embed/9n6UGRKqMjk"
              title="Danny's Agile Automation Story"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              allowfullscreen
              class="w-full h-full"
            ></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Crisis Story Section -->
  <section class="py-16 lg:py-20 bg-[#f0f7ff]">
    <div class="max-w-[1350px] mx-auto px-6 lg:px-8">
      <div class="max-w-3xl mx-auto text-center">

        <!-- H2 Headline - TIGHT line height -->
        <h2 class="text-3xl lg:text-4xl xl:text-5xl font-bold text-[#1a1a1a] leading-none mb-8">
          Companies Made a Choice.<br>
          Keep Facilitators. Or Keep Builders.
        </h2>

        <!-- Body - Creates tension, NO resolution -->
        <p class="text-xl lg:text-2xl text-[#1a1a1a] leading-relaxed mb-4">
          In January 2023, I didn't know which side I was on.
        </p>

        <p class="text-xl lg:text-2xl text-[#1a1a1a] leading-relaxed">
          My certifications said one thing. My resume said another.
        </p>

      </div>
    </div>
  </section>

  <!-- SECTION 3: OPT-IN -->
  <section class="blueprint-optin py-24 lg:py-32 relative overflow-hidden">

    <!-- Dark Grid Background -->
    <div class="absolute inset-0 bg-[#0a1628]">
      <div class="absolute inset-0 opacity-50 grid-pattern"></div>
      <div class="absolute inset-0 bg-gradient-to-b from-[#0a1628] via-transparent to-[#0a1628]"></div>
      <div class="absolute inset-0 bg-gradient-to-b from-transparent via-[#294bf3]/10 to-transparent"></div>
      <div class="absolute inset-0" style="background: radial-gradient(ellipse 60% 50% at 50% 50%, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.02) 40%, transparent 70%);"></div>
    </div>

    <!-- Content -->
    <div class="relative z-10 max-w-[900px] mx-auto px-6 lg:px-8 text-center">

      <!-- Headline -->
      <h2 class="text-3xl lg:text-4xl xl:text-5xl font-bold text-white leading-tight mb-4">
        Not sure which side you're on?
      </h2>

      <!-- Subheadline -->
      <p class="text-lg lg:text-xl text-white/90 font-medium mb-6">
        Get my free Agile AI Prompt Playbook — and start proving technical value before your next interview.
      </p>

      <p class="text-sm text-white/70 italic mb-4">"Designed for Scrum Masters — no coding required."</p>

      <!-- Bridge sentence -->
      <p class="text-base lg:text-lg text-white/80 text-center mb-1">
        These are the same prompts I used before building automation — to think like a builder, speak technically in interviews, and prove value fast.
      </p>

      <!-- Kit.com Clare Form Embed -->
      <div class="max-w-3xl w-full mx-auto mb-10">
        <script async data-uid="fb2e1ff944" src="https://agiletactix.kit.com/fb2e1ff944/index.js"></script>
      </div>

      <!-- Privacy note -->
      <p class="text-sm text-white/60 max-w-xl mx-auto">
        Free instant access. No spam. Unsubscribe anytime.
      </p>

    </div>

  </section>

  <!-- SECTION 4: Why These Prompts Work -->
  <section class="bg-white py-20 lg:py-24">
    <div class="section-container">
      <div class="max-w-4xl mx-auto text-center">

        <!-- Headline -->
        <h2 class="heading-lg text-gray-900 mb-10">
          Why These Prompts Work When Others Don't
        </h2>

        <!-- Body paragraphs -->
        <div class="text-xl text-gray-700 leading-relaxed mb-10">
          <p class="mb-6">
            Most "AI prompt libraries" assume perfect inputs and clean requirements. That's not how real Agile teams work.
          </p>
          <p>
            This playbook was built for messy backlogs, incomplete context, and real delivery pressure.
          </p>
        </div>

        <!-- Subhead -->
        <h3 class="text-xl lg:text-2xl font-semibold text-gray-900 mb-8">
          Inside, you'll learn how to:
        </h3>

        <!-- Bullet list -->
        <ul class="space-y-4 mb-10 inline-block text-left">
          <li class="flex items-start gap-3">
            <svg class="w-6 h-6 text-primary-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
            <span class="text-lg text-gray-700">Use real backlog data instead of fake examples</span>
          </li>
          <li class="flex items-start gap-3">
            <svg class="w-6 h-6 text-primary-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
            <span class="text-lg text-gray-700">Set project context once so AI stops giving generic answers</span>
          </li>
          <li class="flex items-start gap-3">
            <svg class="w-6 h-6 text-primary-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
            <span class="text-lg text-gray-700">Work conversationally, letting AI ask you the right questions</span>
          </li>
          <li class="flex items-start gap-3">
            <svg class="w-6 h-6 text-primary-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
            <span class="text-lg text-gray-700">Generate stories, acceptance criteria, risks, and summaries that actually hold up in reviews</span>
          </li>
          <li class="flex items-start gap-3">
            <svg class="w-6 h-6 text-primary-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
            </svg>
            <span class="text-lg text-gray-700">Produce outputs that sound technical — without writing code</span>
          </li>
        </ul>

        <!-- Body paragraph 3 -->
        <p class="text-xl text-gray-700 leading-relaxed mb-8">
          These aren't one-shot prompts. They're the same conversational patterns used in Fortune 500 delivery teams.
        </p>

        <!-- Closer -->
        <p class="text-base text-gray-500 italic">
          If you've tried AI prompts before and felt underwhelmed, this will feel different.
        </p>

      </div>
    </div>
  </section>

  <!-- SECTION 5: Final Closer -->
  <section class="bg-gray-50 py-20 lg:py-24">
    <div class="section-container">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="heading-lg text-gray-900 mb-12">
          Your Career Is Too Important to Be Limited by Facilitation Skills.
        </h2>

        <div class="text-xl text-gray-700 leading-relaxed space-y-6 mb-10">
          <p>Whether you've been laid off, fear being replaced by AI, or simply want career optionality instead of job dependency—the path is the same.</p>

          <p>Companies aren't cutting agile roles because agile is dead. They're cutting roles that "just coordinate."</p>

          <p class="font-semibold text-gray-900">The professionals who survive and thrive are the ones who can prove they build systems, architect solutions, and create technical value.</p>

          <p class="text-primary-600 font-bold">The free playbook is your first step.</p>
        </div>

        <!-- Final CTA -->
        <button
          type="button"
          data-modal-trigger="playbook"
          class="btn-primary text-lg px-10 py-4"
        >
          <span class="relative z-10">
            Get Your Free Playbook Now
            <svg class="w-5 h-5 ml-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
            </svg>
          </span>
        </button>
      </div>
    </div>
  </section>

  <!-- Playbook Popup Modal (FirstMovers.ai style) -->
  <div
    id="playbook-modal"
    class="fixed inset-0 z-50 hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
  >
    <!-- Dark overlay with blur -->
    <div
      id="modal-overlay"
      class="fixed inset-0 bg-black/70 backdrop-blur-sm"
      aria-hidden="true"
    ></div>

    <!-- Modal Container -->
    <div class="fixed inset-0 overflow-y-auto flex items-center justify-center p-4">
      <!-- Modal Panel -->
      <div
        id="modal-panel"
        class="relative bg-gradient-to-br from-[#294bf3] via-[#1e3acc] to-[#00a8cc] rounded-2xl max-w-5xl w-full shadow-2xl overflow-hidden"
      >
        <!-- Animated stars background -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none" aria-hidden="true">
          <div class="stars-container">
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
          </div>
        </div>

        <!-- Vertical sharp sparkle decorations -->
        <div class="absolute inset-0 pointer-events-none overflow-hidden z-0" aria-hidden="true">
          <!-- Sparkle Group 1: Upper left (primary) -->
          <div class="absolute top-[10%] left-[8%] scale-75 lg:scale-100">
            <!-- Large sparkle - vertical with slight left tilt -->
            <svg width="64" height="64" viewBox="0 0 100 100" fill="none" class="transform -rotate-[102deg]">
              <path d="M50 0 C50 20 40 40 0 50 C40 60 50 80 50 100 C50 80 60 60 100 50 C60 40 50 20 50 0 Z" fill="white" opacity="0.2"/>
            </svg>
            <!-- Small companion sparkle -->
            <svg width="24" height="24" viewBox="0 0 100 100" fill="none" class="absolute -top-2 -right-3 transform -rotate-[75deg]">
              <path d="M50 0 C50 20 40 40 0 50 C40 60 50 80 50 100 C50 80 60 60 100 50 C60 40 50 20 50 0 Z" fill="white" opacity="0.15"/>
            </svg>
          </div>

          <!-- Sparkle Group 2: Upper left (secondary) -->
          <div class="absolute top-[22%] left-[18%] scale-75 lg:scale-100">
            <!-- Medium sparkle - vertical tilted right -->
            <svg width="48" height="48" viewBox="0 0 100 100" fill="none" class="transform -rotate-[65deg]">
              <path d="M50 0 C50 20 40 40 0 50 C40 60 50 80 50 100 C50 80 60 60 100 50 C60 40 50 20 50 0 Z" fill="white" opacity="0.15"/>
            </svg>
            <!-- Small companion sparkle -->
            <svg width="20" height="20" viewBox="0 0 100 100" fill="none" class="absolute -top-1 -right-2 transform -rotate-[100deg]">
              <path d="M50 0 C50 20 40 40 0 50 C40 60 50 80 50 100 C50 80 60 60 100 50 C60 40 50 20 50 0 Z" fill="white" opacity="0.12"/>
            </svg>
          </div>

          <!-- Sparkle Group 3: Upper right (balance) -->
          <div class="absolute top-[12%] right-[10%] hidden sm:block">
            <svg width="40" height="40" viewBox="0 0 100 100" fill="none" class="transform -rotate-[45deg]">
              <path d="M50 0 C50 20 40 40 0 50 C40 60 50 80 50 100 C50 80 60 60 100 50 C60 40 50 20 50 0 Z" fill="white" opacity="0.12"/>
            </svg>
          </div>
        </div>

        <!-- Close button -->
        <button
          id="modal-close"
          type="button"
          class="absolute top-4 right-4 text-white/80 hover:text-white text-3xl z-20 focus:outline-none focus:ring-2 focus:ring-white/50 rounded-lg p-1 transition-colors"
          aria-label="Close modal"
        >
          <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>

        <!-- Content grid -->
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 p-6 sm:p-8 lg:p-12 relative z-10">

          <!-- Left column: Form (3 cols) -->
          <div class="lg:col-span-3">
            <!-- Headline -->
            <h2 id="modal-title" class="text-2xl sm:text-3xl lg:text-4xl font-bold text-white mb-4">
              Your Playbook is Almost Ready...
            </h2>

            <!-- Subheadline -->
            <p class="text-base sm:text-lg text-white/90 mb-6">
              Enter your details below to get the 5-prompt playbook and start sounding technical in every sprint ceremony.
            </p>

            <!-- Benefits List -->
            <ul class="space-y-3 mb-8 text-white/90">
              <li class="flex items-start">
                <svg class="w-6 h-6 mr-3 flex-shrink-0 text-[#00a8cc]" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong class="text-white">5 AI prompts</strong> for sprint planning, refinement & retros</span>
              </li>
              <li class="flex items-start">
                <svg class="w-6 h-6 mr-3 flex-shrink-0 text-[#00a8cc]" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong class="text-white">Copy-paste ready</strong> — works with ChatGPT, Claude, or any AI</span>
              </li>
              <li class="flex items-start">
                <svg class="w-6 h-6 mr-3 flex-shrink-0 text-[#00a8cc]" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong class="text-white">Sound technical</strong> in interviews and sprint ceremonies</span>
              </li>
              <li class="flex items-start">
                <svg class="w-6 h-6 mr-3 flex-shrink-0 text-[#00a8cc]" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong class="text-white">Takes 2 minutes</strong> to read, saves hours every sprint</span>
              </li>
            </ul>

            <!-- Form -->
            <form id="playbook-form" class="space-y-4">
              <!-- First Name -->
              <div>
                <input
                  type="text"
                  name="first_name"
                  id="modal-first-name"
                  placeholder="First name"
                  required
                  class="w-full px-6 py-4 text-lg bg-white/10 backdrop-blur-sm border-2 border-white/30 rounded-lg text-white placeholder-white/60 focus:outline-none focus:border-white/80 transition-colors"
                />
              </div>

              <!-- Email -->
              <div>
                <input
                  type="email"
                  name="email"
                  id="modal-email"
                  placeholder="Enter your email"
                  required
                  class="w-full px-6 py-4 text-lg bg-white/10 backdrop-blur-sm border-2 border-white/30 rounded-lg text-white placeholder-white/60 focus:outline-none focus:border-white/80 transition-colors"
                />
              </div>

              <!-- Submit Button -->
              <button
                type="submit"
                class="w-full px-8 py-4 text-lg font-bold text-[#294bf3] bg-white hover:bg-gray-100 rounded-full transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
              >
                Send Me the Playbook
              </button>
            </form>

            <!-- Privacy Note -->
            <p class="text-sm text-white/70 mt-4">
              By subscribing, you'll also get exclusive automation tactics and AI tips.
            </p>
          </div>

          <!-- Right column: PDF mockup (2 cols) -->
          <div class="lg:col-span-2 flex items-center justify-center">
            <div class="bg-white rounded-lg shadow-2xl p-4 sm:p-6 transform rotate-2 hover:rotate-0 transition-transform duration-300 max-w-[280px] w-full">
              <!-- PDF Cover Design -->
              <div class="bg-gradient-to-br from-[#294bf3] to-[#00a8cc] text-white p-6 sm:p-8 rounded-lg text-center">
                <div class="mb-4 sm:mb-6">
                  <svg class="w-12 h-12 sm:w-16 sm:h-16 mx-auto text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                  </svg>
                </div>

                <h3 class="text-lg sm:text-xl font-bold mb-2">
                  Agile AI Prompt Playbook
                </h3>

                <p class="text-xs sm:text-sm text-white/80 mb-4">
                  5 Copy-Paste Prompts for Agile Professionals
                </p>

                <div class="border-t border-white/20 pt-4 mt-4">
                  <p class="text-xs text-white/70">
                    By Danny Liu<br/>
                    Fortune 500 Agile Analytics Architect
                  </p>
                </div>
              </div>

              <!-- Simulated pages -->
              <div class="mt-4 space-y-2">
                <div class="h-2 bg-gray-200 rounded w-full"></div>
                <div class="h-2 bg-gray-200 rounded w-5/6"></div>
                <div class="h-2 bg-gray-200 rounded w-4/6"></div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</LandingLayout>

<!-- Modal JavaScript -->
<script is:inline>
  document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById('playbook-modal');
    var modalPanel = document.getElementById('modal-panel');
    var overlay = document.getElementById('modal-overlay');
    var closeBtn = document.getElementById('modal-close');
    var firstNameInput = document.getElementById('modal-first-name');
    var form = document.getElementById('playbook-form');
    var triggers = document.querySelectorAll('[data-modal-trigger="playbook"]');

    if (!modal || !modalPanel || !overlay || !closeBtn) return;

    var lastFocusedElement = null;

    function openModal() {
      lastFocusedElement = document.activeElement;
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';

      // Animate in
      modalPanel.style.opacity = '0';
      modalPanel.style.transform = 'scale(0.95)';
      overlay.style.opacity = '0';

      requestAnimationFrame(function() {
        overlay.style.opacity = '1';
        modalPanel.style.opacity = '1';
        modalPanel.style.transform = 'scale(1)';
      });

      // Focus first input after animation
      setTimeout(function() {
        if (firstNameInput) firstNameInput.focus();
      }, 150);
    }

    function closeModal() {
      // Animate out
      overlay.style.opacity = '0';
      modalPanel.style.opacity = '0';
      modalPanel.style.transform = 'scale(0.95)';

      setTimeout(function() {
        modal.classList.add('hidden');
        document.body.style.overflow = '';
        if (lastFocusedElement) lastFocusedElement.focus();
      }, 200);
    }

    // Open modal on trigger click
    triggers.forEach(function(trigger) {
      trigger.addEventListener('click', function(e) {
        e.preventDefault();
        openModal();
      });
    });

    // Close on X button click
    closeBtn.addEventListener('click', closeModal);

    // Close on overlay click
    overlay.addEventListener('click', closeModal);

    // Close on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
        closeModal();
      }
    });

    // Form submission
    if (form) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();

        var formData = new FormData(form);
        var firstName = formData.get('first_name');
        var email = formData.get('email');

        // TODO: Connect to ConvertKit API
        // For now, show success message
        console.log('Form submitted:', { firstName: firstName, email: email });

        alert('Thanks! Check your email for the playbook.');
        closeModal();
        form.reset();
      });
    }
  });
</script>

<style>
  #modal-overlay {
    transition: opacity 200ms ease-out;
  }

  #modal-panel {
    transition: opacity 200ms ease-out, transform 200ms ease-out;
  }

  /* Animated stars */
  .stars-container {
    position: absolute;
    width: 100%;
    height: 100%;
  }

  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: white;
    border-radius: 50%;
    opacity: 0;
    animation: twinkle 4s infinite ease-in-out;
  }

  /* Position stars randomly across the modal */
  .star:nth-child(1) { top: 8%; left: 12%; animation-delay: 0s; }
  .star:nth-child(2) { top: 15%; left: 85%; animation-delay: 0.3s; }
  .star:nth-child(3) { top: 25%; left: 45%; animation-delay: 0.8s; }
  .star:nth-child(4) { top: 35%; left: 72%; animation-delay: 1.2s; }
  .star:nth-child(5) { top: 45%; left: 18%; animation-delay: 1.6s; }
  .star:nth-child(6) { top: 55%; left: 92%; animation-delay: 2s; }
  .star:nth-child(7) { top: 65%; left: 38%; animation-delay: 2.4s; }
  .star:nth-child(8) { top: 75%; left: 65%; animation-delay: 2.8s; }
  .star:nth-child(9) { top: 85%; left: 8%; animation-delay: 3.2s; }
  .star:nth-child(10) { top: 92%; left: 55%; animation-delay: 3.6s; }
  .star:nth-child(11) { top: 12%; left: 32%; animation-delay: 0.5s; }
  .star:nth-child(12) { top: 22%; left: 68%; animation-delay: 1s; }
  .star:nth-child(13) { top: 38%; left: 5%; animation-delay: 1.5s; }
  .star:nth-child(14) { top: 48%; left: 78%; animation-delay: 2s; }
  .star:nth-child(15) { top: 58%; left: 25%; animation-delay: 2.5s; }
  .star:nth-child(16) { top: 68%; left: 88%; animation-delay: 3s; }
  .star:nth-child(17) { top: 78%; left: 42%; animation-delay: 3.5s; }
  .star:nth-child(18) { top: 88%; left: 75%; animation-delay: 0.2s; }
  .star:nth-child(19) { top: 5%; left: 58%; animation-delay: 0.7s; }
  .star:nth-child(20) { top: 30%; left: 95%; animation-delay: 1.3s; }
  .star:nth-child(21) { top: 50%; left: 52%; animation-delay: 1.8s; }
  .star:nth-child(22) { top: 70%; left: 15%; animation-delay: 2.3s; }
  .star:nth-child(23) { top: 82%; left: 35%; animation-delay: 2.9s; }
  .star:nth-child(24) { top: 18%; left: 3%; animation-delay: 3.3s; }
  .star:nth-child(25) { top: 42%; left: 62%; animation-delay: 3.8s; }

  /* Vary star sizes */
  .star:nth-child(3n) { width: 3px; height: 3px; }
  .star:nth-child(5n) { width: 1.5px; height: 1.5px; }
  .star:nth-child(7n) { width: 2.5px; height: 2.5px; }

  /* Add subtle glow to some stars */
  .star:nth-child(4n) {
    box-shadow: 0 0 6px rgba(255, 255, 255, 0.4);
  }

  @keyframes twinkle {
    0%, 100% {
      opacity: 0;
      transform: scale(0.8);
    }
    50% {
      opacity: 0.25;
      transform: scale(1.1);
    }
  }

  /* Grid dot pattern */
  .grid-pattern {
    background-image: radial-gradient(circle at 1px 1px, rgba(41, 75, 243, 0.5) 1px, transparent 0);
    background-size: 40px 40px;
  }

  /* ========================================
     Kit.com Clare Form - Dark Theme Overrides
     ======================================== */

  .blueprint-optin .formkit-form {
    background: transparent !important;
    border: none !important;
    padding: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  .blueprint-optin .formkit-form[data-sv-form] {
    background: transparent !important;
  }

  .blueprint-optin .formkit-background {
    background: transparent !important;
  }

  /* Form fields container - horizontal layout */
  .blueprint-optin .formkit-fields {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: nowrap !important;
    align-items: stretch !important;
    gap: 0.75rem !important;
    background: rgba(255, 255, 255, 0.05) !important;
    border: 1px solid rgba(41, 75, 243, 0.3) !important;
    border-radius: 0.75rem !important;
    padding: 0.75rem !important;
    width: 100% !important;
    max-width: 700px !important;
    margin: 0 auto !important;
  }

  /* Input fields */
  .blueprint-optin .formkit-input,
  .blueprint-optin .formkit-form input[type="text"],
  .blueprint-optin .formkit-form input[type="email"] {
    flex: 1 !important;
    min-width: 0 !important;
    padding: 1rem 1.25rem !important;
    font-size: 1rem !important;
    line-height: 1.5 !important;
    color: #ffffff !important;
    background-color: rgba(255, 255, 255, 0.08) !important;
    border: 1px solid rgba(255, 255, 255, 0.15) !important;
    border-radius: 0.75rem !important;
    outline: none !important;
    transition: border-color 0.2s ease, background-color 0.2s ease !important;
  }

  .blueprint-optin .formkit-input::placeholder,
  .blueprint-optin .formkit-form input::placeholder {
    color: rgba(255, 255, 255, 0.5) !important;
  }

  .blueprint-optin .formkit-input:focus,
  .blueprint-optin .formkit-form input:focus {
    outline: none !important;
    border-color: #294bf3 !important;
    background-color: rgba(255, 255, 255, 0.1) !important;
  }

  /* Submit button - Electric Blue */
  .blueprint-optin .formkit-submit,
  .blueprint-optin .formkit-form button[type="submit"] {
    flex-shrink: 0 !important;
    padding: 1rem 1.75rem !important;
    font-size: 1rem !important;
    font-weight: 700 !important;
    color: #ffffff !important;
    background-color: #294bf3 !important;
    border: none !important;
    border-radius: 0.75rem !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    box-shadow: 0 4px 14px 0 rgba(41, 75, 243, 0.4) !important;
  }

  .blueprint-optin .formkit-submit:hover,
  .blueprint-optin .formkit-form button[type="submit"]:hover {
    background-color: #1e3acc !important;
    box-shadow: 0 6px 20px 0 rgba(41, 75, 243, 0.5) !important;
    transform: translateY(-1px) !important;
  }

  .blueprint-optin .formkit-submit span {
    background: transparent !important;
    padding: 0 !important;
    color: inherit !important;
  }

  /* Hide labels */
  .blueprint-optin .formkit-label {
    display: none !important;
  }

  /* Success state */
  .blueprint-optin .formkit-alert-success {
    background-color: rgba(41, 75, 243, 0.1) !important;
    border: 1px solid rgba(41, 75, 243, 0.3) !important;
    color: #ffffff !important;
    padding: 1rem 1.5rem !important;
    border-radius: 0.75rem !important;
    text-align: center !important;
    font-size: 1rem !important;
  }

  /* Error state */
  .blueprint-optin .formkit-alert-error {
    background-color: rgba(239, 68, 68, 0.1) !important;
    border: 1px solid rgba(239, 68, 68, 0.3) !important;
    color: #ef4444 !important;
    padding: 0.75rem 1rem !important;
    border-radius: 0.5rem !important;
    font-size: 0.875rem !important;
    margin-top: 0.5rem !important;
  }

  /* Hide powered by badge */
  .blueprint-optin .formkit-powered-by,
  .blueprint-optin .formkit-powered-by-convertkit {
    display: none !important;
  }

  /* Spinner */
  .blueprint-optin .formkit-spinner {
    border-color: rgba(255, 255, 255, 0.3) !important;
    border-top-color: #ffffff !important;
  }

  /* Mobile: Stack vertically */
  @media (max-width: 768px) {
    .blueprint-optin .formkit-fields {
      flex-direction: column !important;
      gap: 0.75rem !important;
    }

    .blueprint-optin .formkit-input,
    .blueprint-optin .formkit-form input[type="text"],
    .blueprint-optin .formkit-form input[type="email"] {
      width: 100% !important;
    }

    .blueprint-optin .formkit-submit,
    .blueprint-optin .formkit-form button[type="submit"] {
      width: 100% !important;
    }
  }
</style>

<style is:global>
  form.formkit-form[data-uid="fb2e1ff944"] {
    max-width: 923px !important;
    width: 100% !important;
  }
</style>
